(function(b){var a={dlg_item:null,blocks:b(".connectedSortable"),elitems:b("#essentialitems"),init:function(){b(window).resize();b(".md-bl",a.elitems).draggable({revert:"invalid",connectToSortable:".inner.ui-sortable",handle:"a.handle",helper:function(c){var d="Add the block";if(c.currentTarget!==undefined&&b(c.currentTarget).attr("data-title")!=undefined){d=b(c.currentTarget).attr("data-title")}return b("<div class='ui-widget-header'>"+d+"</div>")}});this.mdcolsort();this.dragBlocks();this.bindClickEvent();this.dlg_item=b("#dlg-item").dialog({resizable:false,autoOpen:false,draggable:false,modal:true,width:480,buttons:{Apply:function(){var c=b(this).data("eitem");c.find("input.setting").val(b("#dlg-item form").serialize());c.addClass("ei-processed");c.find(".ei-text span").html(b("#dlg-item form").find('input[name="title"]').val());b(this).dialog("close");return true},Cancel:function(){b(this).dialog("close")},Remove:function(){b(this).dialog("close");var c=b(this).data("eitem");c.remove()}},close:function(){var c=b(this).data("eitem");if(!c.hasClass("ei-processed")){c.remove()}},open:function(){jQuery(".ui-widget-overlay").bind("click",function(){b("#dlg-item").dialog("close")})}})},bindClickEvent:function(){b(".ei-edit").live("click",function(){a.essentialItems(b(this).parent());return false});b(".ei-remove").live("click",function(){b(this).parent().remove();return false});b(".bl-remove").live("click",function(){b("#blocks").append(b(this).parent());var c=b.unserialize(b(this).parent().find("input[type=hidden]").val()).block_module;b("#"+c).append(b(this).parent());return false})},mdcolsort:function(){b(".inner").sortable({connectWith:".ui-sortable",handle:"a.handle",revert:true,placeholder:"ui-state-highlight",stop:function(c,d){$item=b(d.item);if(!$item.hasClass("ei-processed")){a.essentialItems($item)}}})},dragBlocks:function(){b(a.blocks).sortable({connectWith:".ui-sortable",handle:"a.handle",placeholder:"ui-state-highlight",helper:function(c){var d="Add the block";if(c.currentTarget!==undefined&&b(c.currentTarget).attr("data-title")!=undefined){d=b(c.currentTarget).attr("data-title")}return b("<div class='ui-widget-header'>"+d+"</div>")}}).disableSelection()},essentialItems:function(e){var f="",c="";var d={};if(e.hasClass("ei-processed")){d=e.find("input.setting").val();if(e.hasClass("ei-header")){f="Edit the header"}else{if(e.hasClass("ei-image")){f="Edit the image"}else{if(e.hasClass("ei-html")){c="html";f="Edit HTML code"}else{if(e.hasClass("ei-list")){f="Edit the list"}else{if(e.hasClass("ei-iframe")){f="Edit the iframe"}else{if(e.hasClass("ei-video")){f="Edit the video"}}}}}}}else{if(e.hasClass("ei-header")){c="header";f="Add new header"}else{if(e.hasClass("ei-image")){c="img";f="Add new image"}else{if(e.hasClass("ei-link")){c="a";f="Add new link"}else{if(e.hasClass("ei-html")){c="html";f="Add new HTML code"}else{if(e.hasClass("ei-iframe")){c="iframe";f="Add new iframe"}else{if(e.hasClass("ei-video")){c="video";f="Add new video"}else{if(e.hasClass("ei-textblock")){c="textblock";f="Add new textblock"}else{if(e.hasClass("ei-seperator")){c="seperator";f="Add new seperator"}else{if(e.hasClass("ei-seperatortext")){c="seperatortext";f="Add new seperator with text"}else{if(e.hasClass("ei-flickr")){c="flickr";f="Add new flickr"}else{if(e.hasClass("ei-twitter")){c="twitter";f="Add new twitter"}else{if(e.hasClass("ei-gmap")){c="gmap";f="Add new gmap"}}}}}}}}}}}}d.type=c}if(d.type!="seperator"){b("#dlg-item").loadingDialog();if(c=="html"){a.dlg_item.dialog("option","width",800).dialog("option","height",550)}else{a.dlg_item.dialog("option","width",400).dialog("option","height","auto")}a.dlg_item.data("eitem",e).dialog("option","title",f).dialog("open");b.post(Drupal.settings.basePath+"?q=admin/structure/md-megamenu/essential-item",d,function(g){b("#dlg-item").html(g).unLoadingDialog()})}}};b(window).resize(function(){listcontentw=b(".md-wrap").width()-282;b(".md-listcontent").width(listcontentw)});Drupal.menuItem=a})(jQuery);