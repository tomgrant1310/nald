(function(e){var t={dlg_item:null,blocks:e(".connectedSortable"),elitems:e("#essentialitems"),init:function(){e(window).resize();e(".md-bl",t.elitems).draggable({revert:"invalid",connectToSortable:".inner.ui-sortable",handle:"a.handle",helper:function(t){var n="Add the block";if(t.currentTarget!==undefined&&e(t.currentTarget).attr("data-title")!=undefined){n=e(t.currentTarget).attr("data-title")}return e("<div class='ui-widget-header'>"+n+"</div>")}});this.mdcolsort();this.dragBlocks();this.bindClickEvent();this.dlg_item=e("#dlg-item").dialog({resizable:false,autoOpen:false,draggable:false,modal:true,width:480,buttons:{Apply:function(){var t=e(this).data("eitem");t.find("input.setting").val(e("#dlg-item form").serialize());t.addClass("ei-processed");t.find(".ei-text span").html(e("#dlg-item form").find('input[name="title"]').val());e(this).dialog("close");return true},Cancel:function(){e(this).dialog("close")},Remove:function(){e(this).dialog("close");var t=e(this).data("eitem");t.remove()}},close:function(){var t=e(this).data("eitem");if(!t.hasClass("ei-processed")){t.remove()}},open:function(){jQuery(".ui-widget-overlay").bind("click",function(){e("#dlg-item").dialog("close")})}})},bindClickEvent:function(){e(".ei-edit").live("click",function(){t.essentialItems(e(this).parent());return false});e(".ei-remove").live("click",function(){e(this).parent().remove();return false});e(".bl-remove").live("click",function(){e("#blocks").append(e(this).parent());var t=e.unserialize(e(this).parent().find("input[type=hidden]").val()).block_module;e("#"+t).append(e(this).parent());return false})},mdcolsort:function(){e(".inner").sortable({connectWith:".ui-sortable",handle:"a.handle",revert:true,placeholder:"ui-state-highlight",stop:function(n,r){$item=e(r.item);if(!$item.hasClass("ei-processed")){t.essentialItems($item)}}})},dragBlocks:function(){e(t.blocks).sortable({connectWith:".ui-sortable",handle:"a.handle",placeholder:"ui-state-highlight",helper:function(t){var n="Add the block";if(t.currentTarget!==undefined&&e(t.currentTarget).attr("data-title")!=undefined){n=e(t.currentTarget).attr("data-title")}return e("<div class='ui-widget-header'>"+n+"</div>")}}).disableSelection()},essentialItems:function(n){var r="",i="";var s={};if(n.hasClass("ei-processed")){s=n.find("input.setting").val();if(n.hasClass("ei-header")){r="Edit the header"}else if(n.hasClass("ei-image")){r="Edit the image"}else if(n.hasClass("ei-html")){i="html";r="Edit HTML code"}else if(n.hasClass("ei-list")){r="Edit the list"}else if(n.hasClass("ei-iframe")){r="Edit the iframe"}else if(n.hasClass("ei-video")){r="Edit the video"}}else{if(n.hasClass("ei-header")){i="header";r="Add new header"}else if(n.hasClass("ei-image")){i="img";r="Add new image"}else if(n.hasClass("ei-link")){i="a";r="Add new link"}else if(n.hasClass("ei-html")){i="html";r="Add new HTML code"}else if(n.hasClass("ei-iframe")){i="iframe";r="Add new iframe"}else if(n.hasClass("ei-video")){i="video";r="Add new video"}else if(n.hasClass("ei-textblock")){i="textblock";r="Add new textblock"}else if(n.hasClass("ei-seperator")){i="seperator";r="Add new seperator"}else if(n.hasClass("ei-seperatortext")){i="seperatortext";r="Add new seperator with text"}else if(n.hasClass("ei-flickr")){i="flickr";r="Add new flickr"}else if(n.hasClass("ei-twitter")){i="twitter";r="Add new twitter"}else if(n.hasClass("ei-gmap")){i="gmap";r="Add new gmap"}s.type=i}if(s.type!="seperator"){e("#dlg-item").loadingDialog();if(i=="html"){t.dlg_item.dialog("option","width",800).dialog("option","height",550)}else{t.dlg_item.dialog("option","width",400).dialog("option","height","auto")}t.dlg_item.data("eitem",n).dialog("option","title",r).dialog("open");e.post(Drupal.settings.basePath+"?q=admin/structure/md-megamenu/essential-item",s,function(t){e("#dlg-item").html(t).unLoadingDialog()})}}};e(window).resize(function(){listcontentw=e(".md-wrap").width()-282;e(".md-listcontent").width(listcontentw)});Drupal.menuItem=t})(jQuery)