(function(a){a.fn.choosefont=function(){return this.each(function(){var i=a(this),d=i.attr("id"),h="input[name="+d.replace(/-/g,"_")+"]",f="",j=1;i.find(".form-font").remove();data_arr=a(h).val().split("|");data_arr[0]=typeof data_arr[0]!=="undefined"?data_arr[0]:"0";if(!data_arr[0]){data_arr[0]="0"}data_arr[1]=typeof data_arr[1]!=="undefined"?data_arr[1]:"n4";data_arr[2]=typeof data_arr[2]!=="undefined"?data_arr[2]:"";data_arr[3]=typeof data_arr[3]!=="undefined"?data_arr[3]:"px";data_arr[4]=typeof data_arr[4]!=="undefined"?data_arr[4]:"0";if(!Drupal.settings.font_vars[data_arr[0]]){data_arr[0]="1"}var b=new Array("-","none","capitalize","lowercase","uppercase");html='<div class="form-font">';html+='<label for="'+d+'-fontfamily">Font</label>';html+='<select id="'+d+'-fontfamily" class="form-select2">';a.each(Drupal.settings.font_array,function(k,l){if(k==data_arr[0]){_select=' selected="selected"'}else{_select=""}html+="<option"+_select+' value="'+k+'">'+l+"</option>"});html+="</select>";html+='<div id="fontweight-'+d+'" class="form-font-weight"></div>';html+='<label for="'+d+'-fontsize">size:</label>';html+='<div class="form-font-size"><input type="text" maxlength="128" size="60" value="'+data_arr[2]+'" id="'+d+'-fontsize" class="font-size form-text" /></div>';html+='<select id="'+d+'-sizetype" class="form-select2">';if(data_arr[3]=="em"){html+='<option value="px">px</option><option selected="selected" value="em">em</option>'}else{html+='<option value="px">px</option><option value="em">em</option>'}html+="</select>";html+='<label for="'+d+'-uppercase">Text transform:</label>';html+='<select id="'+d+'-uppercase" class="form-select2">';a.each(b,function(k,l){if(k==data_arr[4]){_select=' selected="selected"'}else{_select=""}html+="<option"+_select+' value="'+l+'">'+l+"</option>"});html+="</select>";html+="</div>";i.prepend(html);f=data_arr[0];fontweight_html='<select id="'+d+'-fontweight" class="form-select3">';fontweight_arr=Drupal.settings.font_vars[f].Weight.split(",");a.each(fontweight_arr,function(k,l){optval=a.trim(l);if(optval==data_arr[1]){_select=' selected="selected"'}else{_select=""}fontweight_html+="<option"+_select+' value="'+optval+'">'+g(optval)+"</option>"});fontweight_html+="</select>";a("#fontweight-"+d).html(fontweight_html);if(!a("#previewbtn-"+d).length){i.addClass("withpreviewbtn").append('<div id="previewbtn-'+d+'" class="previewbtn"><a href="#">Preview</a></div>');i.append('<div id="preview-'+d+'" class="textpreview"><div class="tp-textdemo">Grumpy wizards make toxic brew for the evil Queen and Jack.</div><a href="#" class="tp-close">Close preview</a></div>');a("#previewbtn-"+d+" a").click(function(){e(d);a("#preview-"+d).show();a(this).text("Refresh").addClass("pbtn-refresh");return false});a("#preview-"+d+" .tp-close").click(function(){a(this).parent().hide();a("#previewbtn-"+d+" a").text("Preview").removeClass("pbtn-refresh");return false})}a("#"+d+"-fontfamily").change(function(){f=a(this).val();fontweight_html='<select id="'+d+'-fontweight" class="form-select3">';fontweight_arr=Drupal.settings.font_vars[f].Weight.split(",");a.each(fontweight_arr,function(k,l){optval=a.trim(l);fontweight_html+='<option value="'+optval+'">'+g(optval)+"</option>"});fontweight_html+="</select>";a("#fontweight-"+d).html(fontweight_html);j=1;c()});a(document).delegate("#"+d+"-fontweight","change",function(){c()});a(document).delegate("#"+d+"-fontsize","focusout",function(){c()});a("#"+d+"-sizetype,#"+d+"-uppercase").change(function(){c()});function c(){_fontfamily=a("#"+d+"-fontfamily").val();_fontweight=a("#"+d+"-fontweight").val();_fontsize=a("#"+d+"-fontsize").val();_sizetype=a("#"+d+"-sizetype").val();_uppercase=a("#"+d+"-uppercase").val();_fontfamilydetail=Drupal.settings.font_vars[_fontfamily].CSS;_style="";if(_fontfamily!=0){_style+="font-family: "+_fontfamilydetail+";";if(_fontweight){_style+="font-weight: "+g(_fontweight).toLowerCase()+";"}}if(_fontsize){_style+="font-size: "+_fontsize+_sizetype+";"}if(_uppercase!="-"){_style+="text-transform: "+_uppercase+";"}a(h).val(_fontfamily+"|"+_fontweight+"|"+_fontsize+"|"+_sizetype+"|"+_uppercase+"|"+_style)}function e(k){_fontfamily=a("#"+k+"-fontfamily").val();_fontweight=a("#"+k+"-fontweight").val();_fontsize=a("#"+k+"-fontsize").val();_sizetype=a("#"+k+"-sizetype").val();_texttransform="none";if(a("#"+k+"-uppercase").is(":checked")){_texttransform="uppercase"}_color="#"+a("#"+k).next().find("input.form-colorpicker").val();_fontweightarr=_fontweight.split("");if(_fontweightarr[0]=="i"){_fontweightarr[0]="italic"}else{_fontweightarr[0]="normal"}_fontfamilydetail=Drupal.settings.font_vars[_fontfamily].CSS;a("#preview-"+k+" .tp-textdemo").css({"font-family":_fontfamilydetail,"font-weight":_fontweightarr[1]+"00","font-style":_fontweightarr[0],"font-size":_fontsize+_sizetype,"text-transform":_texttransform,color:_color})}function g(l,k){switch(l){case"n1":fontExpand="Thin";break;case"i1":fontExpand="Thin Italic";break;case"n2":fontExpand="Extra Light";break;case"i2":fontExpand="Extra Light Italic";break;case"n3":fontExpand="Light";break;case"i3":fontExpand="Light Italic";break;case"n4":fontExpand="Normal";break;case"i4":fontExpand="Italic";break;case"n5":fontExpand="Medium";break;case"i5":fontExpand="Medium Italic";break;case"n6":fontExpand="Semi Bold";break;case"i6":fontExpand="Semi Bold Italic";break;case"n7":fontExpand="Bold";break;case"i7":fontExpand="Bold Italic";break;case"n8":fontExpand="Extra Bold";break;case"i8":fontExpand="Extra Bold Italic";break;case"n9":fontExpand="Heavy";break;case"i9":fontExpand="Heavy Italic";break;default:fontExpand="undefined"}return fontExpand}})}})(jQuery);